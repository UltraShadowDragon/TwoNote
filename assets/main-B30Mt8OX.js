import{i as h,g as y,s as w,o as f}from"./index-d0d29856-DYp9bw2V.js";import{g as p,s as k,r as s,a as d,c as S}from"./index.esm2017-CiUmkx34.js";let c;const I=new Uint8Array(16);function U(){if(!c&&(c=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!c))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return c(I)}const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function N(e,o=0){return a[e[o+0]]+a[e[o+1]]+a[e[o+2]]+a[e[o+3]]+"-"+a[e[o+4]]+a[e[o+5]]+"-"+a[e[o+6]]+a[e[o+7]]+"-"+a[e[o+8]]+a[e[o+9]]+"-"+a[e[o+10]]+a[e[o+11]]+a[e[o+12]]+a[e[o+13]]+a[e[o+14]]+a[e[o+15]]}const x=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),m={randomUUID:x};function R(e,o,t){if(m.randomUUID&&!o&&!e)return m.randomUUID();e=e||{};const n=e.random||(e.rng||U)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,N(n)}document.getElementById("#btnOut");var l=null;const D={apiKey:"AIzaSyDLpohSUDg3EB_iNRbXLJhvBrhMyps8lBY",authDomain:"twonote-8563e.firebaseapp.com",databaseURL:"https://twonote-8563e-default-rtdb.firebaseio.com",projectId:"twonote-8563e",storageBucket:"twonote-8563e.appspot.com",messagingSenderId:"811618859430",appId:"1:811618859430:web:454c7b39bbf9239a00f767",measurementId:"G-J6YNSV8EJG"},b=h(D),v=y(b),g=p(b);document.addEventListener("DOMContentLoaded",e=>{$("#exampleModal").on("hide.bs.modal",function(o){var t=$(document.activeElement).attr("id");if(t==="Submit"){var n=$("#notebook-name").val();console.log("Created. "+n);var r=E(n);document.querySelector("#Submit").addEventListener("click",u(n,r,"#allPreview"))}}),$("#btnOut").click(function(){console.log("logged out"),confirm("Are you sure you want to logout?")&&(window.location.replace("/login/"),w(v))})});function E(e){console.log("Saving...");let o=R();return k(s(g,"notebooks/"+o),{name:e,uuid:o,owner:l}).then(()=>{console.log("Saved")}).catch(t=>{console.error("Error saving to the database:",t)}),o}function A(){const e=s(p(),"notebooks");d(e).then(o=>{if(o.exists()){console.log("Data snapshot:",o.val());for(const t in o.val())if(o.val().hasOwnProperty(t)){const n=o.val()[t];console.log("Checking notebook:",n),n.owner.trim()===l?(console.log("Notebook belongs to the user. Creating preview."),u(n.name,n.uuid,"#allPreview")):console.log("Notebook does not belong to the user. Skipping.")}}else console.log("No data available")}).catch(o=>{console.error(o)})}function O(e){const o=s(g,"notebooks/"+e);console.log("Hello, world: ",e),d(S(o,"name")).then(t=>{t.exists()?u(t.val(),e,"#Recentpreview"):console.log("No data available")}).catch(t=>{console.error(t)})}function C(){if(l==null){console.log("OH NO!");return}var e=l.replace(".","-");console.log(e);const o=s(g,"recentlyOpened/"+e);d(o).then(t=>{if(console.log("Snapshot:",t.val()),t.exists()){let n=t.val();console.log("Uuidarray:",n);let r=n.slice(-5);console.log("Last5: ",r);for(let i=n.length-1;i>=0;i--)O(n[i])}else console.log("No data available")}).catch(t=>{console.error("Error retrieving data:",t)})}function u(e,o,t){console.log("Add"),$('<div id="'+o+'" class="card pre-box"></div>').html('<img class="card-img-top" src="https://storage.googleapis.com/media-newsinitiative/images/GO801_GNI_VerifyingPhotos_Card2_image3.original.jpg" alt="Card image cap"><div class="card-body"><p class="card-text">'+e+"</p></div>").appendTo(t),$("#"+o).click(function(){window.location.assign("/notebook/?uuid="+o)})}f(v,e=>{e!=null?(l=e.email,localStorage.setItem("loggedIn",l),console.log("Logged in!",l),A(),C()):(console.log("No user! Please sign in."),window.location.replace("/login/"))});
